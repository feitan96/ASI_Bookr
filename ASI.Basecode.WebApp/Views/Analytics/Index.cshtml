@model ASI.Basecode.Services.ServiceModels.AnalyticsViewModel

@{
    ViewBag.Title = "Analytics";
}

<h2>Analytics</h2>

<div class="card mb-3">
    <div class="card-header">
        <h4>Most Used Room</h4>
    </div>
    <div class="card-body">
        <h5 class="card-title">@Model.MostUsedRoom?.RoomName ?? "No data available"</h5>
        <p class="card-text">
            <strong>Booking Frequency:</strong> @Model.MostUsedRoom?.BookingFrequency ?? 0<br>
            <strong>Total Usage Hours:</strong> @Model.MostUsedRoom?.TotalUsageHours.ToString("F2") ?? "0.00"<br>
            <strong>Peak Usage Hours:</strong> @Model.MostUsedRoom?.PeakUsageHours ?? "N/A"
        </p>
    </div>
</div>


<div class="row">
    <div class="col-md-12">
        <h3>Room Usage Over Time</h3>
        <div id="roomUsageChart"></div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        Highcharts.chart('roomUsageChart', {
            chart: {
                type: 'area'
            },
            title: {
                text: 'Weekly Room Usage (Total Hours)'
            },
            xAxis: {
                categories: @Html.Raw(Json.Serialize(Model.WeeklyRoomUsage.FirstOrDefault()?.Weeks ?? new List<string>())),
                title: {
                    text: 'Weeks'
                }
            },
            yAxis: {
                title: {
                    text: 'Total Usage Hours'
                }
            },
            series: @Html.Raw(Json.Serialize(
         Model.WeeklyRoomUsage.Select(room => new
         {
             name = room.RoomName,
             data = room.WeeklyBookingFrequency
         })
         ))
            });
    });
</script>
